---
title: "Command Reference"
description: "Complete reference for all cloud-dev CLI commands."
---

# Cloud Dev Command Reference

All commands are run from the DevStride repository root:

```bash
./ds cloud-dev <command> [options]
```

## Getting Started

| Command | Description |
|---------|-------------|
| `init` | Configure local environment (run this first!) |
| `create` | Create and fully configure a cloud dev environment |

### `init`

Configure your local environment for cloud-dev. Run this once before using other commands.

```bash
./ds cloud-dev init
```

This will:
- Set `DEVSTRIDE_STAGE` (your developer name)
- Set `AWS_PROFILE` (your AWS SSO profile)
- Update your shell configuration

### `create`

Deploy a new cloud development environment. This is the main command for getting started.

```bash
./ds cloud-dev create [options]
```

**Options:**
| Option | Description |
|--------|-------------|
| `-n, --name <name>` | Developer name (defaults to `DEVSTRIDE_STAGE`) |
| `-i, --instance <id>` | Instance identifier for multiple instances |
| `--skip-setup` | Deploy infrastructure only (skip auto-setup) |
| `--custom-db` | Prompt for custom database (default: use shared dev DB) |
| `--auto-provision-db` | Auto-create a Neon database branch for you |
| `--start-backend` | Start backend in tmux session after setup |
| `--skip-migrations` | Skip running database migrations |
| `--auto-stop <hours>` | Hours of idle before auto-stop (default: 4, set to 0 to disable) |

**Auto-increment for multiple instances:**

When you run `create` and already have existing instances, the CLI automatically detects them and prompts you to create a new one with an incremented name:

```
Checking for existing instances...
   Found existing environments: dev-phil, dev-phil-2
? Create new environment 'dev-phil-3'? (Y/n)
```

This makes it easy to spin up additional instances without manually specifying `-i 3`.

**What it does:**
1. Runs pre-flight checks (Node.js, pnpm, AWS CLI, Git, etc.)
2. Checks for existing instances and suggests next available name
3. Deploys EC2 instance via SST (with auto-stop scheduler)
4. Waits for instance initialization
5. Configures SSH keys and local config
6. Adds GitHub SSH key automatically (via `gh` CLI)
7. Verifies GitHub SSH access works
8. Clones repository and runs `pnpm install`
9. Validates all required secrets are present
10. Creates `.env` with shared secrets (auto-provisions Neon branch if requested)
11. Runs database migrations and verifies connection
12. Optionally starts backend in tmux
13. Sends Slack notification (if configured)

**Example:**
```bash
./ds cloud-dev create                      # Standard create (auto-increments if instances exist)
./ds cloud-dev create --start-backend      # Start backend after setup
./ds cloud-dev create --auto-provision-db  # Auto-create Neon database branch
./ds cloud-dev create --custom-db          # Prompt for your own database
./ds cloud-dev create --auto-stop 0        # Disable auto-stop
./ds cloud-dev create --auto-stop 8        # Stop after 8 hours idle
./ds cloud-dev create -i 2                 # Explicitly create instance 2
./ds cloud-dev create -i feature           # Create named instance (dev-phil-feature)
./ds cloud-dev create --skip-setup         # Infrastructure only
```

::callout{type="tip"}
**Auto-stop saves money!** By default, your instance automatically stops after 4 hours of idle time (CPU < 5%). Use `--auto-stop 0` to disable if needed.
::

---

## Instance Management

| Command | Description |
|---------|-------------|
| `list` | List all your dev instances |
| `start` | Start a stopped instance |
| `stop` | Stop a running instance (preserves data) |
| `info` | Show connection information |
| `destroy` | Remove instance and all AWS resources |
| `cleanup` | Find and remove orphaned cloud resources |
| `verify` | Health check your environment |
| `build-ami` | Build a pre-configured AMI (admin only) |

### `destroy`

Completely remove a cloud environment. **This deletes all data.**

```bash
./ds cloud-dev destroy [options]
```

**Options:**
| Option | Description |
|--------|-------------|
| `-n, --name <name>` | Developer name |
| `-i, --instance <id>` | Instance identifier |
| `-f, --force` | Skip confirmation prompt |

This removes:
- EC2 instance and EBS volume (**all data lost**)
- VPC and networking resources
- Local SSH keys and config
- Auto-stop Lambda and EventBridge rule

### `build-ami`

Build a pre-configured AMI from an existing instance. This creates an image with all dependencies pre-installed for faster instance creation. **Admin use only.**

```bash
./ds cloud-dev build-ami [options]
```

**Options:**
| Option | Description |
|--------|-------------|
| `-n, --name <name>` | Developer name |
| `-i, --instance <id>` | Source instance identifier |
| `--ami-name <name>` | Custom name for the AMI (default: `devstride-cloud-dev`) |

**Example:**
```bash
./ds cloud-dev build-ami                      # Build from your instance
./ds cloud-dev build-ami --ami-name "custom"  # Custom AMI name
```

::callout{type="warning"}
For best results, stop the instance before building an AMI to ensure consistent state.
::

---

## Connectivity

| Command | Description |
|---------|-------------|
| `ssh` | SSH into your instance |
| `ssm` | Connect via AWS SSM (no SSH key needed) |
| `connect` | SSH with port forwarding for local frontend |
| `code` | Open VS Code Remote SSH to instance |
| `claude` | Run Claude Code on your instance |
| `setup` | Configure SSH keys and GitHub access manually |

### `ssh`

Connect to your instance via SSH.

```bash
./ds cloud-dev ssh
./ds cloud-dev ssh -i 2  # Connect to instance 2
```

If SSH keys aren't configured, you'll be prompted to run setup.

### `ssm`

Connect via AWS Systems Manager (useful if SSH is blocked):

```bash
./ds cloud-dev ssm
```

### `connect`

SSH with port forwarding for local frontend development. Run your frontend locally while the backend runs on your cloud instance.

```bash
./ds cloud-dev connect [options]
```

**Options:**
| Option | Description |
|--------|-------------|
| `-p, --ports <ports>` | Comma-separated ports (default: `3000,3001,5173`) |

**Example:**
```bash
./ds cloud-dev connect              # Forward default ports
./ds cloud-dev connect -p 3000,8080 # Custom ports
```

Access points after connecting:
- http://localhost:3000
- http://localhost:3001
- http://localhost:5173

### `code`

Open VS Code with Remote SSH directly to your instance.

```bash
./ds cloud-dev code [options]
```

**Options:**
| Option | Description |
|--------|-------------|
| `-f, --folder <path>` | Folder to open (default: `~/dev/devstride`) |

**Example:**
```bash
./ds cloud-dev code                       # Open devstride folder
./ds cloud-dev code -f ~/dev/other-repo   # Open different folder
```

::callout{type="info"}
Requires VS Code with the "Remote - SSH" extension installed.
::

### `verify`

Run a health check on your cloud dev environment. Checks instance, SSH, repository, .env, Node.js, dependencies, and backend status.

```bash
./ds cloud-dev verify
```

**Example output:**
```
=== Cloud Dev Environment Health Check ===

1. Checking for running instance...
   ✓ Instance: devstride-dev-yourname (i-xxx)
   ✓ IP: 1.2.3.4

2. Checking SSH key...
   ✓ SSH key exists

3. Testing SSH connection...
   ✓ SSH connection successful

4. Checking repository...
   ✓ Repository exists

5. Checking .env file...
   ✓ .env file exists

6. Checking Node.js and pnpm...
   ✓ Node.js: v20.x.x
   ✓ pnpm: v9.x.x

7. Checking dependencies...
   ✓ Dependencies installed

8. Checking if backend is running...
   ○ Backend is not running
   Start with: ds cloud-dev start-backend
```

### `claude`

Launch Claude Code directly on your cloud instance:

```bash
./ds cloud-dev claude
./ds cloud-dev claude -i 2  # On instance 2
```

This SSHs into your instance and starts Claude Code in the `~/dev/devstride` directory. Claude runs with `--dangerously-skip-permissions` to enable autonomous operation.

---

## Remote Development

Run commands on your cloud instance from your local terminal:

| Command | Description |
|---------|-------------|
| `start-backend` | Start backend (`./ds run backend`) |
| `stop-backend` | Stop backend process |
| `start-frontend` | Start frontend (`./ds run ui`) |
| `stop-frontend` | Stop frontend process |
| `run-migrations` | Run database migrations |
| `reset-database` | Reset database from source |
| `logs` | Tail backend logs |

**Example:**
```bash
./ds cloud-dev start-backend  # Runs in your terminal with live output
# Press Ctrl+C to stop
```

### `logs`

Tail logs from the backend. If the backend is running in a tmux session, this attaches to it. Otherwise, it tails SST log files.

```bash
./ds cloud-dev logs
```

Press `Ctrl+C` to stop tailing.

---

## Secrets Management

| Command | Description |
|---------|-------------|
| `init-secrets` | Push local `.env` to AWS Secrets Manager (admin) |
| `setup-secrets` | Fetch secrets from AWS to local `.env` file |
| `list-secrets` | List stored secret keys (not values) |

### `setup-secrets`

Download shared secrets to create your `.env` file:

```bash
./ds cloud-dev setup-secrets
./ds cloud-dev setup-secrets -o .env.local  # Custom output path
```

### `init-secrets` (Admin)

Upload local `.env` to AWS Secrets Manager for team sharing:

```bash
./ds cloud-dev init-secrets
./ds cloud-dev init-secrets -f  # Force overwrite
```

---

## Global Options

These options work with most commands:

| Option | Description |
|--------|-------------|
| `-n, --name <name>` | Developer name (defaults to `DEVSTRIDE_STAGE`) |
| `-i, --instance <id>` | Instance identifier (for multiple instances) |
| `-f, --force` | Skip confirmation prompts |

---

## Interactive Menu

Run without arguments for an interactive menu:

```bash
./ds cloud-dev
```

Or show help:

```bash
./ds cloud-dev help
```
